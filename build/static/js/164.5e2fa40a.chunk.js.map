{"version":3,"sources":["views/pages/Deemand/CreateStage.js"],"names":["CreateStage","isEdit","setIsEdit","useState","AllStage","setAllStage","Demand","setDemand","Project","Building","stage_name","amount","extra_facilities","allBuilding","setAllBuilding","setBuilding","name","value","handleInputs","e","target","AllProjects","setAllProjects","history","useHistory","useEffect","async","res","axios","get","process","Headers","data","getProject","getBuildings","id","length","concat","console","log","getBuildingDetail","getAllStage","React","createElement","Fragment","className","novalidate","onChange","map","i","_id","Name","buildingName","htmlFor","type","required","class","onClick","put","parseFloat","toFixed","status","swal","setTimeout","go","updateFlat","post","window","alert","location","reload","createDemand","j","projectName","Edit","color","size","building","edit","Trash","willDelete","title","text","icon","dangerMode","delete","deleteFlat"],"mappings":"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","file":"static/js/164.5e2fa40a.chunk.js","sourcesContent":["import axios from \"axios\";\nimport React, { useState, useEffect } from \"react\";\nimport { Edit, Trash } from \"react-feather\";\nimport { useHistory } from \"react-router-dom\";\nimport swal from \"sweetalert\";\nconst CreateStage = () => {\n  const [isEdit, setIsEdit] = useState(false);\n  const [AllStage, setAllStage] = useState(null);\n  const [Demand, setDemand] = useState({\n    Project: null, Building: null, stage_name: null, amount: null, extra_facilities: null\n  })\n  const [allBuilding, setAllBuilding] = useState(null);\n  const [Building, setBuilding] = useState(null);\n  let name, value;\n  const handleInputs = (e) => {\n    name = e.target.name;\n    value = e.target.value;\n    setDemand({ ...Demand, [name]: value });\n  }\n  const [AllProjects, setAllProjects] = useState(null);\n  const getProject = async () => {\n    const res = await axios.get(process.env.REACT_APP_PORT + '/api/all/project', {\n      Headers: {\n        'Content-Type': 'application/json'\n      }\n    })\n    setAllProjects(res.data);\n  }\n  var history = useHistory();\n  useEffect(() => {\n    getProject();\n  }, []);\n  const getBuildings = async (id) => {\n    if ((id?.length === 24 || id?.length === 12) && id !== \"Select Project\") {\n      const res = await axios.get(`${process.env.REACT_APP_PORT}/api/buildings/${id}`, {\n        Headers: {\n          'Content-Type': 'application/json'\n        }\n      }\n      );\n      setAllBuilding(res.data);\n      console.log(res.data);\n    }\n  }\n  const getBuildingDetail = async (id) => {\n    if ((id?.length === 24 || id?.length === 12)) {\n      const res = await axios.get(`${process.env.REACT_APP_PORT}/api/building/${id}`, {\n        Headers: {\n          'Content-Type': 'application/json'\n        }\n      }\n      );\n      setBuilding(res.data);\n      console.log(res.data);\n    }\n  }\n\n  const createDemand = async()=>{\n    const res = await axios.post(process.env.REACT_APP_PORT + '/api/create/demand',{\n      Project: Demand.Project,\n      Building: Demand.Building,\n      stage_name: Demand.stage_name,\n      amount: parseFloat(Demand.amount).toFixed(2),\n      extra_facilities: Demand.extra_facilities\n    })\n    if(res.status === 200){\n      window.alert('Stage Created!');\n      window.location.reload();\n    }else{\n      window.alert('Something went wrong!');\n    }\n  }\n  const edit = async(data)=>{\n    setDemand({...Demand, Project: data?.Project, Building: data?.Building, stage_name: data?.stage_name, amount: data?.amount, extra_facilities: data?.extra_facilities,id:data?._id});\n    setIsEdit(true)\n    await getBuildings(data?.Project);\n    setDemand({...Demand,building:data?.building});\n    await getBuildingDetail(data?.building);\n    setDemand({...Demand, Project: data?.Project, Building: data?.Building, stage_name: data?.stage_name, amount: data?.amount, extra_facilities: data?.extra_facilities,id:data?._id});\n   }\n   const deleteFlat= async(id)=>{\n   const willDelete = await swal({\n     title: \"Are you sure?\",\n       text: \"Are you sure that you want to delete this Block?\",\n       icon: \"warning\",\n       dangerMode: true,\n     });\n      \n     if (willDelete) {\n       const res = await axios.delete(process.env.REACT_APP_PORT + '/api/delete/flat/'+id,{\n         Headers: {\n           'Content-Type': 'application/json'\n         }\n       })\n       getAllStage();\n     }\n     willDelete();\n   }\n   const updateFlat = async(id)=>{\n     const res = await axios.put(process.env.REACT_APP_PORT + '/api/update/demand/'+id,{\n      Project: Demand.Project,\n      Building: Demand.Building,\n      stage_name: Demand.stage_name,\n      amount: parseFloat(Demand.amount).toFixed(2),\n      extra_facilities: Demand.extra_facilities\n     })\n     if(res.status===200){\n       swal('Stage Updated successfully!','success')\n       setTimeout(() => {\n         history.go(0);\n       }, 2000);\n     }\n   }\n  const getAllStage = async()=>{\n      const res = await axios.get(`${process.env.REACT_APP_PORT}/api/get/all/demand`,{\n        Headers: {\n          'Content-Type': 'application/json'\n        }\n      })\n      setAllStage(res.data);\n  }\n  useEffect(() => {\n    getAllStage();\n  }, [])\n  \n  return (\n    <>\n      <div className=\"container bg-white p-2 rounded-2\">\n        <form\n          className=\"row px-4 py-4 mx-2 my-2 shadow-lg needs-validation\"\n          novalidate\n        >\n          <h3 className=\"text-alternate text-primary\">Payment Plans</h3>\n          <hr />\n          <div className=\"col-md-6 col-12 mb-2\">\n            <p className=\"text-alternate\">Select Project</p>\n            <div className=\"input-group\">\n            <select className=\"form-control\" id=\"project\" onChange={(e) => { handleInputs(e); getBuildings(e.target.value); }} name=\"Project\" value={Demand.Project}>\n                {AllProjects === null ?\n                  <option value={null} name={null}>Loading...</option>\n                  : <option value={null} name={null}>Select Project</option>}\n                {AllProjects !== null && AllProjects?.length === 0 &&\n                  <option value={null} name={null}>No projects Avaliable</option>\n                }\n                {AllProjects !== null && AllProjects?.length > 0 && AllProjects.map((i) => {\n                  return (\n                    <option name={i?._id} value={i?._id}>{i?.Name}</option>\n                  )\n                })\n                }\n              </select>\n            </div>\n          </div>          \n          <div className=\"col-md-6 col-12 mb-2\">\n            <p className=\"text-alternate\">Select Building</p>\n            <div className=\"input-group\">\n            <select className=\"form-control\" id=\"building\" name=\"Building\" onChange={(e)=>{handleInputs(e);getBuildingDetail(e.target.value)}} value={Demand.Building} >\n                {Demand.Project === null ? <option value={null} name={null} >First select Project</option>\n                  : <>\n                    {allBuilding === null && <option value={null} name={null} >Loading...</option>}\n                    {allBuilding !== null && allBuilding?.length === 0 && <option value={null} name={null} >No Building Avaliable</option>}\n                  </>\n                }\n                {allBuilding?.length > 0 &&\n                  <>\n                    <option value={null} name={null} >Select Building</option>\n                    {\n                      allBuilding?.map((i) => {\n                        return (\n                          <>\n                            <option value={i?._id} name={i?._id}>{i?.buildingName}</option>\n                          </>\n                        )\n                      })\n                    }\n\n                  </>\n                }\n              </select>\n            </div>\n          </div>\n\n          <div className=\"col-md-6 col-12 mb-2\">\n            <label htmlFor=\"stageName\" className=\"text-alternate mb-2\">\n              {\" \"}\n              Stage Name\n            </label>\n            <input\n              type=\"text\"\n              className=\"form-control\"\n              id=\"stageName\"\n              name=\"stage_name\"\n              onChange={handleInputs}\n              value={Demand.stage_name}\n              required=\"\"\n            />\n          </div>\n          <div className=\"col-md-6 col-12 mb-2\">\n            <label htmlFor=\"ammount\" className=\"text-alternate mb-2\">\n              {\" \"}\n              Demand Rate(%)\n            </label>\n            <input\n              type=\"text\"\n              className=\"form-control\"\n              id=\"ammount\"\n              name=\"amount\"\n              onChange={handleInputs}\n              value={Demand.amount}\n              required=\"\"\n            />\n          </div>\n\n\n          <div className=\"col-md-12 col-12 text-right\">\n          {isEdit ? (\n              <>\n                <button\n                  type=\"button\"\n                  class=\"btn btn-outline-warning btn-md mb-1 mr-1\"\n                  onClick={() => {\n                    setDemand({\n                      ...Demand,\n                      Project: null, Building: null, stage_name: null, amount: null, extra_facilities: null,id:null\n                    });\n                    setIsEdit(false);\n                  }}\n                >\n                  {\" \"}\n                  Exit{\" \"}\n                </button>\n                <button\n                  type=\"button\"\n                  class=\"btn btn-outline-primary btn-md mb-1 mr-1\"\n                  onClick={() => updateFlat(Demand.id)}\n                >\n                  {\" \"}\n                  Update{\" \"}\n                </button>\n              </>\n            ) : (\n              <button\n                type=\"button\"\n                class=\"btn btn-outline-primary btn-md mb-1 mr-1\"\n                onClick={() => createDemand()}\n              >\n                {\" \"}\n                Create{\" \"}\n              </button>\n            )}\n           </div>\n        </form>\n        {!isEdit &&\n          <form\n            className=\"row px-4 py-4 mx-2 my-2 shadow-lg needs-validation\"\n            novalidate\n          >\n            <h3 className=\"text-alternate text-primary\">All Plans</h3>\n            <div className=\"d-flex justify-content-center\">\n              <table className=\"table table-striped table-responsive\">\n                <tr>\n                  <th>Sno.</th>\n                  <th>Project</th>\n                  <th>Building</th>\n                  <th>Stage Name</th>\n                  <th>Demand Rate(%)</th>\n                  <th>Action</th>\n                </tr>\n                {AllStage?.map((i, j) => {\n                  let id = i?._id;\n                  return (\n                    <tr>\n                      <td>{j + 1}</td>\n                      <td>{i?.projectName}</td>\n                      <td>{i?.buildingName}</td>\n                      <td>{i?.stage_name}</td>\n                      <td>{i?.amount}</td>\n                      <td>\n                        <Edit className=\"cursor-pointer\" color=\"green\" size={30} onClick={() => { edit(i) }} />\n                        <Trash\n                          className=\"cursor-pointer\"\n                          color=\"red\"\n                          size={30}\n                          onClick={() => {\n                            deleteFlat(id);\n                          }}\n                        />\n                      </td>\n                    </tr>\n                  );\n                })}\n              </table>\n            </div>\n          </form>\n        }\n      </div>\n    </>\n  );\n};\n\nexport default CreateStage;\n"],"sourceRoot":""}