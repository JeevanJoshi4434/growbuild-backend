{"version":3,"sources":["views/Demand/RaiseDemand.jsx"],"names":["RaiseDemand","demand","setDemand","useState","Project","Building","paymentPlan","allBuilding","setAllBuilding","DemandList","setDemandList","name","value","handleInputs","e","target","AllProjects","setAllProjects","useEffect","async","res","axios","get","process","Headers","data","getProject","getDetail","id","length","concat","React","createElement","Fragment","class","className","onChange","getBuildings","map","i","_id","Name","buildingName","stage_name","type","disabled","onClick","put","Status","onlyStatus","status","alert","error"],"mappings":"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","file":"static/js/153.07c51ef7.chunk.js","sourcesContent":["import axios from \"axios\";\r\nimport React from \"react\";\r\nimport { useState, useEffect } from \"react\";\r\n\r\nconst RaiseDemand = () => {\r\n\r\n  const [demand, setDemand] = useState({\r\n    Project: '', Building: '', paymentPlan: ''\r\n  })\r\n  const [allBuilding, setAllBuilding] = useState(null);\r\n  const [DemandList, setDemandList] = useState([]);\r\n  let name, value;\r\n  const handleInputs = (e) => {\r\n    name = e.target.name;\r\n    value = e.target.value;\r\n    setDemand({ ...demand, [name]: value });\r\n  }\r\n  const [AllProjects, setAllProjects] = useState(null);\r\n  const getProject = async () => {\r\n    const res = await axios.get(process.env.REACT_APP_PORT + '/api/all/project', {\r\n      Headers: {\r\n        'Content-Type': 'application/json'\r\n      }\r\n    })\r\n    setAllProjects(res.data);\r\n  }\r\n  useEffect(() => {\r\n    getProject();\r\n  }, []);\r\n  const getBuildings = async (id) => {\r\n    if ((id?.length === 24 || id?.length === 12) && id !== \"Select Project\") {\r\n      const res = await axios.get(`${process.env.REACT_APP_PORT}/api/buildings/${id}`, {\r\n        Headers: {\r\n          'Content-Type': 'application/json'\r\n        }\r\n      }\r\n      );\r\n      setAllBuilding(res.data);\r\n    }\r\n  }\r\n  const getDetail = async (id) => {\r\n    if ((id?.length === 24 || id?.length === 12)) {\r\n      const res = await axios.get(`${process.env.REACT_APP_PORT}/api/demand/status/${id}/${demand.Project}/pending`, {\r\n        Headers: {\r\n          'Content-Type': 'application/json'\r\n        }\r\n      }\r\n      );\r\n      setDemandList(res.data);\r\n    }\r\n  }\r\n\r\n  const updateDemand = async () => {\r\n    try {\r\n\r\n      const res = await axios.put(process.env.REACT_APP_PORT + `/api/update/demand/${demand.paymentPlan}`,\r\n        { Status: 'completed', onlyStatus: true }\r\n      );\r\n      if (res.status === 200) {\r\n        alert(\"Demand Raised successfully\");\r\n        getDetail(demand.Building);\r\n      }else{\r\n        alert(\"Something went wrong, try again later.\");\r\n      }\r\n\r\n    } catch (error) {\r\n      alert(\"Something went wrong, try again later.\");\r\n    }\r\n  }\r\n  return (\r\n    <>\r\n      <div class=\"container bg-white p-2 rounded-2\">\r\n        <form class=\"row px-4 py-4 mx-2 my-2 justify-content-center shadow-lg\">\r\n          <h3 class=\"text-alternate text-primary\">Raise Demand</h3>\r\n          <hr />\r\n          <div className=\"col-md-6 col-12 mb-2\">\r\n            <p className=\"text-alternate\">Select Project</p>\r\n            <div className=\"input-group\">\r\n              <select className=\"form-control\" id=\"project\" onChange={(e) => { handleInputs(e); getBuildings(e.target.value); }} name=\"Project\" value={demand.Project}>\r\n                {AllProjects === null ?\r\n                  <option value={null} name={null}>Loading...</option>\r\n                  : <option value={null} name={null}>Select Project</option>}\r\n                {AllProjects !== null && AllProjects?.length === 0 &&\r\n                  <option value={null} name={null}>No projects Avaliable</option>\r\n                }\r\n                {AllProjects !== null && AllProjects?.length > 0 && AllProjects.map((i) => {\r\n                  return (\r\n                    <option name={i?._id} value={i?._id}>{i?.Name}</option>\r\n                  )\r\n                })\r\n                }\r\n              </select>\r\n            </div>\r\n          </div>\r\n          <div className=\"col-md-6 col-12 mb-2\">\r\n            <p className=\"text-alternate\">Select Building</p>\r\n            <div className=\"input-group\">\r\n              <select className=\"form-control\" id=\"building\" name=\"Building\" onChange={(e) => { handleInputs(e); getDetail(e.target.value) }} value={demand.Building} >\r\n                {demand.Project === null ? <option value={null} name={null} >First select Project</option>\r\n                  : <>\r\n                    {allBuilding === null && <option value={null} name={null} >Loading...</option>}\r\n                    {allBuilding !== null && allBuilding?.length === 0 && <option value={null} name={null} >No Building Available</option>}\r\n                  </>\r\n                }\r\n                {allBuilding?.length > 0 &&\r\n                  <>\r\n                    <option value={null} name={null} >Select Building</option>\r\n                    {\r\n                      allBuilding?.map((i) => {\r\n                        return (\r\n                          <>\r\n                            <option value={i?._id} name={i?._id}>{i?.buildingName}</option>\r\n                          </>\r\n                        )\r\n                      })\r\n                    }\r\n\r\n                  </>\r\n                }\r\n              </select>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-md-8 col-12 mb-2\">\r\n            <p class=\"text-alternate\">Select Payment Plan</p>\r\n            <div class=\"input-group\">\r\n              <select class=\"form-control\" id=\"paymentPlan\" name=\"paymentPlan\" onChange={handleInputs} value={demand.paymentPlan}>\r\n                {allBuilding === null && <option value=''>Select Building First</option>}\r\n                <option value='' >Select Payment Plan</option>\r\n                {\r\n                  DemandList.length > 0 && DemandList.map((i) => {\r\n                    return (\r\n                      <option name={i?._id} value={i?._id}>{i?.stage_name}</option>\r\n                    )\r\n                  })\r\n                }\r\n              </select>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-md-4 col-12 mb-2\">\r\n            <p class=\"text-alternate\">Raise Demands For this Plan</p>\r\n            <button type=\"button\" disabled={demand.paymentPlan.length > 0 ? false : true} onClick={updateDemand} class=\"btn btn-success\">\r\n              Set Plan Active\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default RaiseDemand;\r\n"],"sourceRoot":""}